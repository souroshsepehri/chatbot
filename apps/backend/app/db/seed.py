"""
Database seeding script for demo data

Usage:
    python -m app.db.seed
"""

from sqlalchemy.orm import Session
from app.db.session import SessionLocal
from app.models.kb_qa import KBQA
from app.models.website_source import WebsiteSource
import sys


def seed_qa_items(db: Session):
    """Seed QA items"""
    qa_data = [
        {
            "question": "ุณุงุนุงุช ฺฉุงุฑ ุดูุง ฺุณุชุ",
            "answer": "ุณุงุนุงุช ฺฉุงุฑ ูุง ุงุฒ ุดูุจู ุชุง ูพูุฌุดูุจู ุงุฒ ุณุงุนุช 9 ุตุจุญ ุชุง 6 ุนุตุฑ ุงุณุช. ุฌูุนูโูุง ุชุนุทู ูโุจุงุดู."
        },
        {
            "question": "ุขุฏุฑุณ ุฏูุชุฑ ูุฑฺฉุฒ ฺฉุฌุงุณุชุ",
            "answer": "ุฏูุชุฑ ูุฑฺฉุฒ ูุง ุฏุฑ ุชูุฑุงูุ ุฎุงุจุงู ููุนุตุฑุ ูพูุงฺฉ 1234 ูุงูุน ุดุฏู ุงุณุช."
        },
        {
            "question": "ฺุทูุฑ ูโุชูุงูู ุจุง ุดูุง ุชูุงุณ ุจฺฏุฑูุ",
            "answer": "ูโุชูุงูุฏ ุงุฒ ุทุฑู ุดูุงุฑู ุชููู 021-12345678 ุง ุงูู info@example.com ุจุง ูุง ุชูุงุณ ุจฺฏุฑุฏ."
        },
        {
            "question": "ุขุง ุงูฺฉุงู ุจุงุฒุฏุฏ ุงุฒ ุฏูุชุฑ ูุฌูุฏ ุฏุงุฑุฏุ",
            "answer": "ุจููุ ุจุง ููุงููฺฏ ูุจู ูโุชูุงูุฏ ุงุฒ ุฏูุชุฑ ูุง ุจุงุฒุฏุฏ ฺฉูุฏ. ูุทูุงู ุงุฒ ุทุฑู ุงูู ุง ุชููู ููุงููฺฏ ฺฉูุฏ."
        },
        {
            "question": "ุดูุง ฺู ููุน ุดุฑฺฉุช ูุณุชุฏุ",
            "answer": "ูุง ฺฉ ุดุฑฺฉุช ููุงูุฑ ุงุทูุงุนุงุช ูุณุชู ฺฉู ุฏุฑ ุฒููู ุชูุณุนู ูุฑูโุงูุฒุงุฑ ู ุฑุงูโุญูโูุง ููุดููุฏ ูุนุงูุช ูโฺฉูู."
        },
        {
            "question": "ฺู ุฎุฏูุงุช ุงุฑุงุฆู ูโุฏูุฏุ",
            "answer": "ูุง ุฎุฏูุงุช ุชูุณุนู ูุฑูโุงูุฒุงุฑุ ุทุฑุงุญ ูุจโุณุงุชุ ุงูพูฺฉุดู ููุจุงู ู ูุดุงูุฑู ููุงูุฑ ุงุทูุงุนุงุช ุงุฑุงุฆู ูโุฏูู."
        },
        {
            "question": "ููุช ุฎุฏูุงุช ุดูุง ฺูุฏุฑ ุงุณุชุ",
            "answer": "ููุช ุฎุฏูุงุช ุจุณุชู ุจู ููุน ูพุฑูฺู ู ูุงุฒูุง ุดูุง ูุชูุงูุช ุงุณุช. ูุทูุงู ุจุฑุง ุฏุฑุงูุช ููุช ุฏูู ุจุง ูุง ุชูุงุณ ุจฺฏุฑุฏ."
        },
        {
            "question": "ุขุง ฺฏุงุฑุงูุช ุจุฑุง ุฎุฏูุงุช ุดูุง ูุฌูุฏ ุฏุงุฑุฏุ",
            "answer": "ุจููุ ุชูุงู ุฎุฏูุงุช ูุง ุฏุงุฑุง ฺฏุงุฑุงูุช ู ูพุดุชุจุงู ูพุณ ุงุฒ ุชุญูู ูโุจุงุดูุฏ. ูุฏุช ุฒูุงู ฺฏุงุฑุงูุช ุจุณุชู ุจู ููุน ุฎุฏูุช ูุชูุงูุช ุงุณุช."
        },
        {
            "question": "ฺูุฏุฑ ุทูู ูโฺฉุดุฏ ุชุง ูพุฑูฺู ุชุญูู ุฏุงุฏู ุดูุฏุ",
            "answer": "ุฒูุงู ุชุญูู ูพุฑูฺู ุจุณุชู ุจู ูพฺุฏฺฏ ู ุญุฌู ฺฉุงุฑ ูุชูุงูุช ุงุณุช. ูุนูููุงู ุจู 2 ุชุง 8 ููุชู ุจุฑุง ูพุฑูฺูโูุง ูุชูุณุท."
        },
        {
            "question": "ุขุง ุงูฺฉุงู ุณูุงุฑุดโุณุงุฒ ูุฌูุฏ ุฏุงุฑุฏุ",
            "answer": "ุจููุ ุชูุงู ุฎุฏูุงุช ูุง ูุงุจู ุณูุงุฑุดโุณุงุฒ ุจุฑ ุงุณุงุณ ูุงุฒูุง ุฎุงุต ุดูุง ูโุจุงุดูุฏ."
        },
        {
            "question": "ฺู ุฑูุดโูุง ูพุฑุฏุงุฎุช ุฑุง ูโูพุฐุฑุฏุ",
            "answer": "ูุง ูพุฑุฏุงุฎุช ููุฏุ ฺฺฉุ ฺฉุงุฑุชโูุง ุจุงูฺฉ ู ูพุฑุฏุงุฎุช ุขููุงู ุฑุง ูโูพุฐุฑู."
        },
        {
            "question": "ุขุง ุงูฺฉุงู ูพุฑุฏุงุฎุช ุงูุณุงุท ูุฌูุฏ ุฏุงุฑุฏุ",
            "answer": "ุจููุ ุจุฑุง ูพุฑูฺูโูุง ุจุฒุฑฺฏ ุงูฺฉุงู ูพุฑุฏุงุฎุช ุงูุณุงุท ูุฌูุฏ ุฏุงุฑุฏ. ุฌุฒุฆุงุช ุฑุง ูโุชูุงูุฏ ุจุง ุชู ูุฑูุด ูุง ุฏุฑ ูุงู ุจฺฏุฐุงุฑุฏ."
        },
        {
            "question": "ฺุทูุฑ ูโุชูุงูู ุงุฒ ูพุดุชุจุงู ูู ุงุณุชูุงุฏู ฺฉููุ",
            "answer": "ูโุชูุงูุฏ ุงุฒ ุทุฑู ุชฺฉุช ุณุณุชูุ ุงูู support@example.com ุง ุชูุงุณ ุชููู ุจุง ุชู ูพุดุชุจุงู ุฏุฑ ุงุฑุชุจุงุท ุจุงุดุฏ."
        },
        {
            "question": "ุณุงุนุงุช ูพุดุชุจุงู ูู ฺุณุชุ",
            "answer": "ูพุดุชุจุงู ูู ูุง ุฏุฑ ุณุงุนุงุช ุงุฏุงุฑ (9 ุตุจุญ ุชุง 6 ุนุตุฑ) ู ููฺูู 24/7 ุจุฑุง ูุดุชุฑุงู VIP ุฏุฑ ุฏุณุชุฑุณ ุงุณุช."
        },
        {
            "question": "ุงฺฏุฑ ูุดฺฉู ูพุด ุขูุฏ ฺุทูุฑ ุจุงุฏ ฺฏุฒุงุฑุด ุฏููุ",
            "answer": "ูโุชูุงูุฏ ูุดฺฉู ุฑุง ุงุฒ ุทุฑู ุชฺฉุช ุณุณุชูุ ุงูู ุง ุชูุงุณ ุชููู ฺฏุฒุงุฑุด ุฏูุฏ. ุชู ูุง ุฏุฑ ุงุณุฑุน ููุช ูพุงุณุฎ ูโุฏูุฏ."
        },
        {
            "question": "ุขุง ุขููุฒุด ุงุณุชูุงุฏู ุงุฒ ูุญุตููุงุช ุงุฑุงุฆู ูโุฏูุฏุ",
            "answer": "ุจููุ ูุง ุขููุฒุดโูุง ฺฉุงูู ู ูุณุชูุฏุงุช ุฌุงูุน ุจุฑุง ุชูุงู ูุญุตููุงุช ุฎูุฏ ุงุฑุงุฆู ูโุฏูู."
        },
        {
            "question": "ฺูุฏุฑ ุทูู ูโฺฉุดุฏ ุชุง ูุดฺฉู ุญู ุดูุฏุ",
            "answer": "ุฒูุงู ุญู ูุดฺฉู ุจุณุชู ุจู ููุน ู ูพฺุฏฺฏ ุขู ูุชูุงูุช ุงุณุช. ูุดฺฉูุงุช ุณุงุฏู ูุนูููุงู ุฏุฑ ููุงู ุฑูุฒ ู ูุดฺฉูุงุช ูพฺุฏูโุชุฑ ุฏุฑ ุญุฏุงฺฉุซุฑ 3 ุฑูุฒ ฺฉุงุฑ ุญู ูโุดููุฏ."
        },
        {
            "question": "ุขุง ุงุทูุงุนุงุช ูู ุงูู ุงุณุชุ",
            "answer": "ุจููุ ูุง ุงุฒ ุจุงูุงุชุฑู ุงุณุชุงูุฏุงุฑุฏูุง ุงููุช ุจุฑุง ูุญุงูุธุช ุงุฒ ุงุทูุงุนุงุช ุดูุง ุงุณุชูุงุฏู ูโฺฉูู."
        },
        {
            "question": "ุขุง ูโุชูุงูู ูพุฑูฺู ุฑุง ูุบู ฺฉููุ",
            "answer": "ุจููุ ุงูฺฉุงู ูุบู ูพุฑูฺู ูุฌูุฏ ุฏุงุฑุฏ. ุฌุฒุฆุงุช ุดุฑุงุท ูุบู ุฏุฑ ูุฑุงุฑุฏุงุฏ ุดูุง ุฐฺฉุฑ ุดุฏู ุงุณุช."
        },
        {
            "question": "ุขุง ุงูฺฉุงู ุจุงุฒฺฏุดุช ูุฌู ูุฌูุฏ ุฏุงุฑุฏุ",
            "answer": "ุจููุ ุฏุฑ ุตูุฑุช ุนุฏู ุฑุถุงุช ุงุฒ ุฎุฏูุงุชุ ุงูฺฉุงู ุจุงุฒฺฏุดุช ูุฌู ุทุจู ุดุฑุงุท ูุฑุงุฑุฏุงุฏ ูุฌูุฏ ุฏุงุฑุฏ."
        },
        {
            "question": "ฺุทูุฑ ูโุชูุงูู ุงุฒ ุขุฎุฑู ุงุฎุจุงุฑ ู ุจูโุฑูุฒุฑุณุงูโูุง ูุทูุน ุดููุ",
            "answer": "ูโุชูุงูุฏ ุฏุฑ ุฎุจุฑูุงูู ูุง ุนุถู ุดูุฏ ุง ูุง ุฑุง ุฏุฑ ุดุจฺฉูโูุง ุงุฌุชูุงุน ุฏูุจุงู ฺฉูุฏ ุชุง ุงุฒ ุขุฎุฑู ุงุฎุจุงุฑ ูุทูุน ุดูุฏ."
        },
    ]
    
    created_count = 0
    skipped_count = 0
    
    for qa in qa_data:
        # Check if QA already exists
        existing = db.query(KBQA).filter(
            KBQA.question == qa["question"]
        ).first()
        
        if existing:
            skipped_count += 1
            print(f"  - Skipped existing QA: {qa['question'][:50]}...")
        else:
            qa_item = KBQA(
                question=qa["question"],
                answer=qa["answer"]
            )
            db.add(qa_item)
            created_count += 1
            print(f"  โ Created QA: {qa['question'][:50]}...")
    
    print(f"\nโ Created {created_count} QA items, skipped {skipped_count} existing")
    return created_count


def seed_website_source(db: Session):
    """Seed a fake disabled website source"""
    fake_url = "https://example-demo-site.com"
    
    # Check if already exists
    existing = db.query(WebsiteSource).filter(
        WebsiteSource.base_url == fake_url
    ).first()
    
    if existing:
        print(f"โ Website source '{fake_url}' already exists")
        return existing
    else:
        website_source = WebsiteSource(
            base_url=fake_url,
            enabled=False,  # Disabled as requested
            crawl_status="idle"
        )
        db.add(website_source)
        print(f"โ Created fake website source: {fake_url} (disabled)")
        return website_source


def main():
    """Main seeding function"""
    print("๐ฑ Starting database seeding...\n")
    
    db: Session = SessionLocal()
    try:
        # Seed QA items
        print("โ Seeding QA items...")
        seed_qa_items(db)
        db.commit()
        print()
        
        # Seed website source
        print("๐ Seeding website source...")
        seed_website_source(db)
        db.commit()
        print()
        
        print("โ Database seeding completed successfully!")
        print("\n๐ Summary:")
        print(f"   - QA Items: {db.query(KBQA).count()}")
        print(f"   - Website Sources: {db.query(WebsiteSource).count()}")
        
    except Exception as e:
        db.rollback()
        print(f"\nโ Error during seeding: {e}")
        import traceback
        traceback.print_exc()
        sys.exit(1)
    finally:
        db.close()


if __name__ == "__main__":
    main()



